# 希尔排序
"""
希尔排序：是插入排序的一种，也称缩小增量排序。是插入排序算法的一种更高效的改进版本。希尔排序是非稳定排序算法。

核心思想：
希尔排序通过将待排序数组按照一定的间隔（增量）分成若干个子序列，对每个子序列分别进行插入排序，
然后逐步缩小间隔，重复这个过程，直到间隔为1时，对整个数组进行一次插入排序，完成排序。

算法步骤：
1.取一个小于待排序列表长度的正整数d1，把所有距离为d1的数据看成一组，在组内进行插入排序。
2.再取一个小于d1的正整数d2，继续用d2分组进行组内插入排序。
3.取的分组距离越来越小，组内的数据越来越多，直到d(n)=1，所有数据被分成一组，再进行插入排序，则列表排序完成。

例如，对于数组 [8, 9, 1, 7, 2, 3, 5, 4, 6, 0]，初始间隔为5：
- 分成5个子序列：[8,3] [9,5] [1,4] [7,6] [2,0]，分别排序
- 缩小间隔为2，分成2个子序列：[8,1,2,5,6] [9,7,3,4,0]，分别排序
- 最后间隔为1，对整个数组进行插入排序
"""
def shell_sort(arr):
    """
    希尔排序函数
    
    Args:
        arr: 待排序的列表
    
    Returns:
        排序后的列表
    """
    n = len(arr)
    # 定一个初始的间隔
    gap = n // 2
    
    print(f"初始数组: {arr}, 初始间隔: {gap}")
    
    # 步长逐渐减小，直到为1
    while gap > 0:
        print(f"\n--- 当前间隔为 {gap} ---")
        # 从间隔的索引开始，对每个子序列进行插入排序
        for i in range(gap, n):
            # 保存当前元素，以备插入到正确的位置
            temp = arr[i]
            j = i
            print(f"  处理元素 arr[{i}] = {temp}")
            
            # 对当前元素前面的子序列进行插入排序
            # j >= gap 确保j不会超出子序列的范围
            # arr[j - gap] > temp 确保只有当子序列中的元素大于temp时才进行交换
            while j >= gap and arr[j - gap] > temp:
                # 将子序列中的元素后移，为temp腾出位置
                arr[j] = arr[j - gap]
                print(f"    将 arr[{j - gap}] = {arr[j]} 移动到位置 {j}")
                # 更新j的值，以继续与前面的元素比较
                j -= gap
            
            # 将temp插入到正确的位置
            arr[j] = temp
            print(f"    将 {temp} 插入到位置 {j}, 数组变为: {arr}")
            
        # 缩小间隔，通常每次缩小为原来的一半
        gap //= 2
        print(f"  间隔缩小为: {gap}")

    return arr


# 测试代码
arr = [8, 9, 1, 7, 2, 3, 5, 4, 6, 0]
print(f"原始数组: {arr}")
arr_shell_sort = shell_sort(arr)
print(f"\n希尔排序后的数组: {arr_shell_sort}")
